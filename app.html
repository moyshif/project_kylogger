from flask import Flask, request, jsonify
from flask_cors import CORS
import threading
import datetime
import time

app = Flask(__name__)
CORS(app)  # מאפשר חיבור מה-Frontend

running = False

def collect_keys():
    global running
    while running:
        time.sleep(5)
        print("איסוף נתונים...")  # כאן תוכל להוסיף שמירת נתונים לקובץ

@app.route('/start', methods=['POST'])
def start_keylogger():
    global running
    if not running:
        running = True
        threading.Thread(target=collect_keys, daemon=True).start()
        return jsonify({"status": "Keylogger started"})
    return jsonify({"status": "Already running"})

@app.route('/stop', methods=['POST'])
def stop_keylogger():
    global running
    if running:
        running = False
        return jsonify({"status": "Keylogger stopped"})
    return jsonify({"status": "Already stopped"})

if __name__ == '__main__':
    app.run(host="0.0.0.0", port=5000, debug=True)
